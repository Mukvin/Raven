database: raven_tpch_100_db
max_worker_num: 10000
queries:
- at_second: 0
  id: query_0
  sql: "\n\n\nselect\n\n\tl_returnflag,\n\n\tl_linestatus,\n\n\tsum(l_quantity) as\
    \ sum_qty,\n\n\tsum(l_extendedprice) as sum_base_price,\n\n\tsum(l_extendedprice\
    \ * (1 - l_discount)) as sum_disc_price,\n\n\tsum(l_extendedprice * (1 - l_discount)\
    \ * (1 + l_tax)) as sum_charge,\n\n\tavg(l_quantity) as avg_qty,\n\n\tavg(l_extendedprice)\
    \ as avg_price,\n\n\tavg(l_discount) as avg_disc,\n\n\tcount(*) as count_order\n\
    \nfrom\n\n\tlineitem\n\nwhere\n\n\tcast(l_shipdate as Date) <= date '1998-12-01'\
    \ - interval '64' day  \n\ngroup by\n\n\tl_returnflag,\n\n\tl_linestatus\n\norder\
    \ by\n\n\tl_returnflag,\n\n\tl_linestatus \n\n  \n"
- at_second: 30
  id: query_1
  sql: "\n\n\nselect\n\n\ts_acctbal,\n\n\ts_name,\n\n\tn_name,\n\n\tp_partkey,\n\n\
    \tp_mfgr,\n\n\ts_address,\n\n\ts_phone,\n\n\ts_comment\n\nfrom\n\n\tpartsupp\n\
    \n\tleft join part on p_partkey = ps_partkey\n\n\tleft join supplier on s_suppkey\
    \ = ps_suppkey\n\n\tleft join nation on s_nationkey = n_nationkey\n\n\tleft join\
    \ region on n_regionkey = r_regionkey\n\n\tinner join (\n\n\tselect\n\n\t\tp_partkey\
    \ as min_p_partkey,\n\n\t\tmin(ps_supplycost) as min_ps_supplycost\n\n\tfrom\n\
    \n\t\tpartsupp\n\n\t\tleft join part on p_partkey = ps_partkey\n\n\t\tleft join\
    \ supplier on s_suppkey = ps_suppkey\n\n\t\tleft join nation on s_nationkey =\
    \ n_nationkey\n\n\t\tleft join region on n_regionkey = r_regionkey\n\n\twhere\n\
    \n\t\tr_name = 'AMERICA'\n\n\tgroup by\n\n\t\tp_partkey\n\n) on ps_supplycost\
    \ = min_ps_supplycost and p_partkey = min_p_partkey\n\nwhere\n\n\tp_size = 9\n\
    \n\tand p_type like '%COPPER'\n\n\tand r_name = 'AMERICA'\n\norder by\n\n\ts_acctbal\
    \ desc,\n\n\tn_name,\n\n\ts_name,\n\n\tp_partkey \n\nlimit 100 \n"
- at_second: 60
  id: query_2
  sql: "\n\n\n\n\nselect\n\n\tl_orderkey,\n\n\tsum(l_extendedprice * (1 - l_discount))\
    \ as revenue,\n\n\to_orderdate,\n\n\to_shippriority\n\nfrom\n\n\tlineitem\n\n\
    \    left join orders on l_orderkey = o_orderkey\n\n    left join customer on\
    \ c_custkey = o_custkey\n\nwhere\n\n\tc_mktsegment = 'HOUSEHOLD'\n\n\tand cast(o_orderdate\
    \ as Date) < date '1995-03-28'\n\n\tand cast(l_shipdate as Date) > date '1995-03-28'\n\
    \ngroup by\n\n\tl_orderkey,\n\n\to_orderdate,\n\n\to_shippriority\n\norder by\n\
    \n\trevenue desc,\n\n\to_orderdate \n\nlimit 10 "
- at_second: 90
  id: query_3
  sql: "\n\n\n\n\nselect\n\n\to_orderpriority,\n\n\tcount(*) as order_count\n\nfrom\n\
    \n    (\n\n        select\n\n            l_orderkey,\n\n            o_orderpriority\n\
    \n        from\n\n            lineitem\n\n            left join orders on l_orderkey\
    \ = o_orderkey\n\n        where\n\n            cast(o_orderdate as Date) >= date\
    \ '1995-01-01'\n\n\t\t\tand cast(o_orderdate as Date) < date '1995-01-01' + interval\
    \ '3' month\n\n            and l_commitdate < l_receiptdate\n\n        group by\n\
    \n            l_orderkey,\n\n            o_orderpriority\n\n    ) t\n\ngroup by\n\
    \n\tt.o_orderpriority\n\norder by\n\n\tt.o_orderpriority \n"
- at_second: 120
  id: query_4
  sql: "\n\n\nselect\n\n\tsn.n_name,\n\n\tsum(l_extendedprice * (1 - l_discount))\
    \ as revenue\n\nfrom\n\n\tlineitem\n\n    left join orders on l_orderkey = o_orderkey\n\
    \n    left join customer on o_custkey = c_custkey\n\n    left join nation cn on\
    \ c_nationkey = cn.n_nationkey\n\n    left join supplier on l_suppkey = s_suppkey\n\
    \n    left join nation sn on s_nationkey = sn.n_nationkey\n\n    left join region\
    \ on sn.n_regionkey = r_regionkey\n\nwhere\n\n\tcn.n_name = sn.n_name\n\n\tand\
    \ r_name = 'EUROPE'\n\n\tand cast(o_orderdate as Date) >= date '1993-01-01'\n\n\
    \tand cast(o_orderdate as Date) < date '1993-01-01' + interval '1' year\n\ngroup\
    \ by\n\n\tsn.n_name\n\norder by\n\n\trevenue desc \n\n\n\n\n\n  \n"
- at_second: 150
  id: query_5
  sql: "\n\n\nselect\n\n\tsum(l_extendedprice * l_discount) as revenue\n\nfrom\n\n\
    \tlineitem\n\nwhere\n\n\tcast(l_shipdate as Date) >= date '1993-01-01'\n\n\tand\
    \ cast(l_shipdate as Date) < date '1993-01-01' + interval '1' year\n\n\tand l_discount\
    \ between 0.07 - 0.01 and 0.07 + 0.01\n\n\tand l_quantity < 25 \n\n  \n"
- at_second: 180
  id: query_6
  sql: "\n\n\nselect\n\n\tsupp_nation,\n\n\tcust_nation,\n\n\tl_year,\n\n\tsum(volume)\
    \ as revenue\n\nfrom\n\n\t(\n\n\t\tselect\n\n\t\t\tn1.n_name as supp_nation,\n\
    \n\t\t\tn2.n_name as cust_nation,\n\n\t\t\textract(year from cast(l_shipdate as\
    \ Date)) as l_year,\n\n\t\t\tl_extendedprice * (1 - l_discount) as volume\n\n\t\
    \tfrom\n\n\t\t\tlineitem \n\n\t\t\tleft join supplier on s_suppkey = l_suppkey\n\
    \n\t\t\tleft join orders on l_orderkey = o_orderkey\n\n\t\t\tleft join customer\
    \ on o_custkey = c_custkey\n\n\t\t\tleft join nation n1 on s_nationkey = n1.n_nationkey\n\
    \n\t\t\tleft join nation n2 on c_nationkey = n2.n_nationkey\n\n\t\twhere\n\n\t\
    \t\t(\n\n\t\t\t\t(n1.n_name = 'INDIA' and n2.n_name = 'MOZAMBIQUE')\n\n\t\t\t\t\
    or (n1.n_name = 'MOZAMBIQUE' and n2.n_name = 'INDIA')\n\n\t\t\t)\n\n\t\t\tand\
    \ cast(l_shipdate as Date) between date '1995-01-01' and date '1996-12-31'\n\n\
    \t) as shipping\n\ngroup by\n\n\tsupp_nation,\n\n\tcust_nation,\n\n\tl_year\n\n\
    order by\n\n\tsupp_nation,\n\n\tcust_nation,\n\n\tl_year \n"
- at_second: 210
  id: query_7
  sql: "\n\n\nselect\n\n\to_year,\n\n\tsum(case\n\n\t\twhen nation = 'INDIA' then\
    \ volume\n\n\t\telse 0\n\n\tend) / sum(volume) as mkt_share\n\nfrom\n\n\t(\n\n\
    \t\tselect\n\n\t\t\textract(year from cast(o_orderdate as Date)) as o_year,\n\n\
    \t\t\tl_extendedprice * (1 - l_discount) as volume,\n\n\t\t\tn2.n_name as nation\n\
    \n\t\tfrom\n\n\t\t\tlineitem\n\n\t\t    left join part on l_partkey = p_partkey\n\
    \n\t\t    left join supplier on l_suppkey = s_suppkey\n\n\t\t\tleft join orders\
    \ on l_orderkey = o_orderkey\n\n\t\t\tleft join customer on o_custkey = c_custkey\n\
    \n\t\t    left join nation n1 on c_nationkey = n1.n_nationkey\n\n\t\t    left\
    \ join nation n2 on s_nationkey = n2.n_nationkey\n\n\t\t    left join region on\
    \ n1.n_regionkey = r_regionkey\n\n\t\twhere\n\n\t\t\tr_name = 'ASIA'\n\n\t\t\t\
    and cast(o_orderdate as Date) between date '1995-01-01' and date '1996-12-31'\n\
    \n\t\t\tand p_type = 'MEDIUM POLISHED TIN'\n\n\t) as all_nations\n\ngroup by\n\
    \n\to_year\n\norder by\n\n\to_year "
- at_second: 240
  id: query_8
  sql: "\n\n\nselect\n\n\tnation,\n\n\to_year,\n\n\tsum(amount) as sum_profit\n\n\
    from\n\n\t(\n\n\t\tselect\n\n\t\t\tn_name as nation,\n\n\t\t\textract(year from\
    \ cast(o_orderdate as Date)) as o_year,\n\n\t\t\tl_extendedprice * (1 - l_discount)\
    \ - ps_supplycost * l_quantity as amount\n\n\t\tfrom\n\n\t\t\tlineitem\n\n\t\t\
    \tleft join part on l_partkey = p_partkey\n\n\t\t\tleft join supplier on l_suppkey\
    \ = s_suppkey\n\n\t\t\tleft join partsupp on l_suppkey = ps_suppkey and l_partkey\
    \ = ps_partkey\n\n\t\t\tleft join orders on l_orderkey = o_orderkey\n\n\t\t\t\
    left join nation on s_nationkey = n_nationkey\n\n\t\twhere\n\n\t\t\t\n\n\t\t\t\
    p_name like '%grey%'\n\n\t) as profit\n\ngroup by\n\n\tnation,\n\n\to_year\n\n\
    order by\n\n\tnation,\n\n\to_year desc \n\n  "
- at_second: 270
  id: query_9
  sql: "\n\n\nselect\n\n\tc_custkey,\n\n\tc_name,\n\n\tsum(l_extendedprice * (1 -\
    \ l_discount)) as revenue,\n\n\tc_acctbal,\n\n\tn_name,\n\n\tc_address,\n\n\t\
    c_phone,\n\n\tc_comment\n\nfrom\n\n\tlineitem\n\n    left join orders on l_orderkey\
    \ = o_orderkey\n\n\tleft join customer on c_custkey = o_custkey\n\n    left join\
    \ nation on c_nationkey = n_nationkey\n\nwhere\n\n\n\n\n\n\tcast(o_orderdate as\
    \ Date) >= date '1994-04-01'\n\n\tand cast(o_orderdate as Date) < date '1994-04-01'\
    \ + interval '3' month\n\n\tand l_returnflag = 'R'\n\n\n\ngroup by\n\n\tc_custkey,\n\
    \n\tc_name,\n\n\tc_acctbal,\n\n\tc_phone,\n\n\tn_name,\n\n\tc_address,\n\n\tc_comment\n\
    \norder by\n\n\trevenue desc \n\nlimit 20 \n"
- at_second: 300
  id: query_10
  sql: "\n\n\n\n\nselect\n\n\tps_partkey, \n\n\tpart_value\n\nfrom (\n\n\tselect\n\
    \n\t\tps_partkey,\n\n\t\tpart_value,\n\n\t\ttotal_value\n\n\tfrom\n\n\t\t(\n\n\
    \tselect\n\n\t\tps_partkey,\n\n\t\tsum(ps_supplycost * ps_availqty) as part_value\n\
    \n\tfrom\n\n\t\tpartsupp\n\n\t\tleft join supplier on ps_suppkey = s_suppkey\n\
    \n\t\tleft join nation on s_nationkey = n_nationkey\n\n\twhere\n\n\t\tn_name =\
    \ 'CANADA'\n\n\tgroup by ps_partkey\n\n), (\n\n\tselect\n\n\t\tsum(part_value)\
    \ as total_value\n\n\tfrom\n\n\t\t(\n\n\tselect\n\n\t\tps_partkey,\n\n\t\tsum(ps_supplycost\
    \ * ps_availqty) as part_value\n\n\tfrom\n\n\t\tpartsupp\n\n\t\tleft join supplier\
    \ on ps_suppkey = s_suppkey\n\n\t\tleft join nation on s_nationkey = n_nationkey\n\
    \n\twhere\n\n\t\tn_name = 'CANADA'\n\n\tgroup by ps_partkey\n\n)\n\n))\n\n\n\n\
    where\n\n\tpart_value > total_value * 0.0000010000\n\norder by\n\n\tpart_value\
    \ desc\n\n\n"
- at_second: 330
  id: query_11
  sql: "\n\n\nselect\n\n\tl_shipmode,\n\n\tsum(case\n\n\t\twhen o_orderpriority =\
    \ '1-URGENT'\n\n\t\t\tor o_orderpriority = '2-HIGH'\n\n\t\t\tthen 1\n\n\t\telse\
    \ 0\n\n\tend) as high_line_count,\n\n\tsum(case\n\n\t\twhen o_orderpriority <>\
    \ '1-URGENT'\n\n\t\t\tand o_orderpriority <> '2-HIGH'\n\n\t\t\tthen 1\n\n\t\t\
    else 0\n\n\tend) as low_line_count\n\nfrom\n\n\tlineitem left join orders on l_orderkey\
    \ = o_orderkey\n\nwhere\n\n\tl_shipmode in ('SHIP', 'AIR')\n\n\tand l_commitdate\
    \ < l_receiptdate\n\n\tand l_shipdate < l_commitdate\n\n\tand cast(l_receiptdate\
    \ as Date) >= date '1995-01-01'\n\n\tand cast(l_receiptdate as Date) < date '1995-01-01'\
    \ + interval '1' year\n\ngroup by\n\n\tl_shipmode\n\norder by\n\n\tl_shipmode\
    \ \n\n  \n"
- at_second: 360
  id: query_12
  sql: "\n\n\nselect\n\n\tc_count,\n\n\tcount(*) as custdist\n\nfrom\n\n\t(\n\n\t\t\
    select\n\n\t\t\tc_custkey,\n\n\t\t\tcount(o_orderkey)\n\n\t\tfrom\n\n\t\t\tcustomer\
    \ left outer join orders on\n\n\t\t\t\tc_custkey = o_custkey\n\n\t\t\t\tand o_comment\
    \ not like '%pending%requests%'\n\n\t\tgroup by\n\n\t\t\tc_custkey\n\n\t) as c_orders\
    \ (c_custkey, c_count)\n\ngroup by\n\n\tc_count\n\norder by\n\n\tcustdist desc,\n\
    \n\tc_count desc \n\n  \n"
- at_second: 390
  id: query_13
  sql: "\n\n\nselect\n\n\t100.00 * sum(case\n\n\t\twhen p_type like 'PROMO%'\n\n\t\
    \t\tthen l_extendedprice * (1 - l_discount)\n\n\t\telse 0\n\n\tend) / sum(l_extendedprice\
    \ * (1 - l_discount)) as promo_revenue\n\nfrom\n\n\tlineitem \n\n\t    left join\
    \ part on l_partkey = p_partkey\n\nwhere\n\n\tcast(l_shipdate as Date) >= date\
    \ '1995-09-01'\n\n\tand cast(l_shipdate as Date) < date '1995-09-01' + interval\
    \ '1' month \n\n  \n"
- at_second: 420
  id: query_14
  sql: "\n\n\n\n\n\n\nselect\n\n    s_suppkey,\n\n    s_name,\n\n    s_address,\n\n\
    \    s_phone,\n\n    total_revenue\n\nfrom\n\n    (\n\n    select\n\n        s_suppkey,\n\
    \n        s_name,\n\n        s_address,\n\n        s_phone,\n\n        sum(l_extendedprice\
    \ * (1 - l_discount)) as total_revenue\n\n    from\n\n        lineitem\n\n   \
    \     left join supplier on s_suppkey=l_suppkey\n\n    where\n\n        cast(l_shipdate\
    \ as Date) >= date '1995-04-01'\n\n\t\t\t\t\tand cast(l_shipdate as Date) < date\
    \ '1995-04-01' + interval '3' month\n\n    group by s_suppkey,s_name,s_address,s_phone\n\
    \n)\n\n    inner join (\n\n    select\n\n        max(total_revenue) as max_revenue\n\
    \n    from\n\n    \t(\n\n    select\n\n        s_suppkey,\n\n        s_name,\n\
    \n        s_address,\n\n        s_phone,\n\n        sum(l_extendedprice * (1 -\
    \ l_discount)) as total_revenue\n\n    from\n\n        lineitem\n\n        left\
    \ join supplier on s_suppkey=l_suppkey\n\n    where\n\n        cast(l_shipdate\
    \ as Date) >= date '1995-04-01'\n\n\t\t\t\t\tand cast(l_shipdate as Date) < date\
    \ '1995-04-01' + interval '3' month\n\n    group by s_suppkey,s_name,s_address,s_phone\n\
    \n)\n\n        \n\n)\n\n on total_revenue = max_revenue\n\norder by s_suppkey\n\
    \n\n\n\n"
- at_second: 450
  id: query_15
  sql: "\n\n\n\n\nselect\n\n\tp_brand,\n\n\tp_type,\n\n\tp_size,\n\n\tcount(distinct\
    \ ps_suppkey) as supplier_cnt\n\nfrom\n\n\tpartsupp \n\n\tleft join part on p_partkey\
    \ = ps_partkey\n\n\tleft join supplier on ps_suppkey = s_suppkey\n\nwhere\n\n\t\
    \n\n\tp_brand <> 'Brand#15'\n\n\tand p_type not like 'ECONOMY BURNISHED%'\n\n\t\
    and p_size in (21, 37, 33, 22, 28, 24, 29, 39)\n\n\tand \n\n\t\t\ts_comment not\
    \ like '%Customer%Complaints%'\n\n\t\n\ngroup by\n\n\tp_brand,\n\n\tp_type,\n\n\
    \tp_size\n\norder by\n\n\tsupplier_cnt desc,\n\n\tp_brand,\n\n\tp_type,\n\n\t\
    p_size "
- at_second: 480
  id: query_16
  sql: "\n\n\nselect sum(l_extendedprice) / 7.0 as avg_yearly\n\nfrom\n\n    lineitem\n\
    \n    left join part on l_partkey = p_partkey\n\n    inner join (\n\n    select\n\
    \n        l_partkey,\n\n        0.2 * avg(l_quantity) as t_avg_quantity\n\n  \
    \  from\n\n        lineitem\n\n    group by\n\n        l_partkey\n\n) q17_avg\
    \ on q17_avg.l_partkey = lineitem.l_partkey\n\nwhere \n\n    p_brand = 'Brand#51'\n\
    \n    and p_container = 'MED JAR'\n\n    and l_quantity < t_avg_quantity\n\n\n\
    \n\n"
- at_second: 510
  id: query_17
  sql: "\n\n\nselect\n\n    c_name,\n\n    c_custkey,\n\n    o_orderkey,\n\n    o_orderdate,\n\
    \n    o_totalprice,\n\n    sum(l_quantity)\n\nfrom\n\n    lineitem\n\n    left\
    \ join orders on l_orderkey = o_orderkey\n\n    left join customer on o_custkey\
    \ = c_custkey\n\nwhere\n\n    o_orderkey is not null\n\ngroup by\n\n    c_name,\n\
    \n    c_custkey,\n\n    o_orderkey,\n\n    o_orderdate,\n\n    o_totalprice\n\n\
    having\n\n    sum(l_quantity) > 313\n\norder by\n\n    o_totalprice desc,\n\n\
    \    o_orderdate \n\nlimit 100\n"
- at_second: 540
  id: query_18
  sql: "\n\n\nselect\n\n\tsum(l_extendedprice* (1 - l_discount)) as revenue\n\nfrom\n\
    \n\tlineitem left join \n\n\tpart on p_partkey = l_partkey\n\nwhere\n\n\t(\n\n\
    \t\t\n\n\t\tp_brand = 'Brand#45'\n\n\t\tand p_container in ('SM CASE', 'SM BOX',\
    \ 'SM PACK', 'SM PKG')\n\n\t\tand l_quantity >= 1 and l_quantity <= 1 + 10\n\n\
    \t\tand p_size between 1 and 5\n\n\t\tand l_shipmode in ('AIR', 'AIR REG')\n\n\
    \t\tand l_shipinstruct = 'DELIVER IN PERSON'\n\n\t)\n\n\tor\n\n\t(\n\n\t\t\n\n\
    \t\tp_brand = 'Brand#41'\n\n\t\tand p_container in ('MED BAG', 'MED BOX', 'MED\
    \ PKG', 'MED PACK')\n\n\t\tand l_quantity >= 10 and l_quantity <= 10 + 10\n\n\t\
    \tand p_size between 1 and 10\n\n\t\tand l_shipmode in ('AIR', 'AIR REG')\n\n\t\
    \tand l_shipinstruct = 'DELIVER IN PERSON'\n\n\t)\n\n\tor\n\n\t(\n\n\n\n\t\tp_brand\
    \ = 'Brand#25'\n\n\t\tand p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG\
    \ PKG')\n\n\t\tand l_quantity >= 21 and l_quantity <= 21 + 10\n\n\t\tand p_size\
    \ between 1 and 15\n\n\t\tand l_shipmode in ('AIR', 'AIR REG')\n\n\t\tand l_shipinstruct\
    \ = 'DELIVER IN PERSON'\n\n\t) \n\n  \n"
- at_second: 570
  id: query_19
  sql: "\n\n\n\n\n\n\nselect\n\n    s_name,\n\n    s_address\n\nfrom\n\n    partsupp\n\
    \n    left join supplier on ps_suppkey = s_suppkey\n\n    inner join  (\n\n  \
    \  select l_partkey, 0.5 * sum(l_quantity) as sum_quantity, l_suppkey\n\n    from\
    \ lineitem\n\n    left join supplier on l_suppkey = s_suppkey\n\n    left join\
    \ nation on s_nationkey = n_nationkey\n\n    left join part on l_partkey = p_partkey\n\
    \n    where cast(l_shipdate as Date) >= date '1994-01-01'\n\n\t\t\t\t\tand cast(l_shipdate\
    \ as Date) < date '1994-01-01' + interval '1' year\n\n    and n_name = 'CHINA'\n\
    \n    and p_name like 'hot%'\n\n    group by l_partkey, l_suppkey\n\n) on ps_partkey\
    \ = l_partkey and ps_suppkey = l_suppkey\n\nwhere\n\n    ps_availqty > sum_quantity\n\
    \ngroup by\n\n    s_name, s_address\n\norder by\n\n    s_name\n\n\n\n\n\n  \n"
- at_second: 600
  id: query_20
  sql: "\n\n\nselect s_name, count(*) as numwait\n\nfrom\n\n(\n\n    select\n\n  \
    \      l1.l_suppkey,\n\n        s_name,\n\n        l1.l_orderkey\n\n    from\n\
    \n        lineitem l1\n\n        left join orders on l1.l_orderkey = o_orderkey\n\
    \n        left join supplier on l1.l_suppkey = s_suppkey\n\n        left join\
    \ nation on s_nationkey = n_nationkey\n\n        inner join (\n\n            select\n\
    \n                l_orderkey,\n\n                count (distinct l_suppkey)\n\n\
    \            from\n\n                lineitem left join orders on l_orderkey =\
    \ o_orderkey\n\n            where\n\n                o_orderstatus = 'F'\n\n \
    \           group by\n\n                l_orderkey\n\n            having\n\n \
    \               count (distinct l_suppkey) > 1\n\n        ) l2 on l1.l_orderkey\
    \ = l2.l_orderkey\n\n        inner join (\n\n            select\n\n          \
    \      l_orderkey,\n\n                count (distinct l_suppkey)\n\n         \
    \   from\n\n                lineitem left join orders on l_orderkey = o_orderkey\n\
    \n            where\n\n                o_orderstatus = 'F'\n\n               \
    \ and l_receiptdate > l_commitdate\n\n            group by\n\n               \
    \ l_orderkey\n\n            having\n\n                count (distinct l_suppkey)\
    \ = 1\n\n        ) l3 on l1.l_orderkey = l3.l_orderkey\n\n    where\n\n      \
    \  o_orderstatus = 'F'\n\n        and l_receiptdate > l_commitdate\n\n       \
    \ and n_name = 'ARGENTINA'\n\n    group by\n\n        l1.l_suppkey,\n\n      \
    \  s_name,\n\n        l1.l_orderkey\n\n)\n\ngroup by\n\n    s_name\n\norder by\n\
    \n    numwait desc,\n\n    s_name\n\nlimit 100\n\n\n\n\n"
- at_second: 630
  id: query_21
  sql: "\n\n\n\n\n\n\nselect\n\n    cntrycode,\n\n    count(1) as numcust,\n\n   \
    \ sum(c_acctbal) as totacctbal\n\nfrom (\n\n    select\n\n        substring(c_phone,\
    \ 1, 2) as cntrycode,\n\n        c_acctbal\n\n    from \n\n        customer inner\
    \ join \n\n\n\n        (\n\n    select c_custkey as noordercus\n\n    from\n\n\
    \        customer left join orders on c_custkey = o_custkey\n\n    where o_orderkey\
    \ is null\n\n    group by c_custkey\n\n\t\t)\n\n\n\n         on c_custkey = noordercus,\
    \ \n\n\n\n        (\n\n    select\n\n        avg(c_acctbal) as avg_acctbal\n\n\
    \    from\n\n        customer\n\n    where\n\n        c_acctbal > 0.00 and substring(c_phone,\
    \ 1, 2) in ('33', '13', '23', '27', '20', '16', '18')\n\n)\n\n\n\n    where \n\
    \n        substring(c_phone, 1, 2) in ('33', '13', '23', '27', '20', '16', '18')\n\
    \n        and c_acctbal > avg_acctbal\n\n) t\n\ngroup by\n\n    cntrycode\n\n\
    order by\n\n    cntrycode\n"
